<div class="app-container">

  <div class="sidebar-overlay" 
       [class.show]="isSidebarOpen" 
       (click)="closeSidebar()">
  </div>

  <div class="sidebar" [class.show]="isSidebarOpen">
    <div class="sidebar-header">
      <h2 class="sidebar-logo">
        <i class="material-symbols-outlined">delivery_truck_speed</i>SpeedLog
      </h2>
    </div>

    <ul class="nav-menu">
      <!-- DASHBOARD: Admin & Operator -->
      <li class="nav-item" *ngIf="isAdmin || isOperator">
        <a routerLink="/app/dashboard" routerLinkActive="active" class="nav-link" (click)="closeSidebar()">
          <i class="material-symbols-outlined">dashboard</i> Dashboard
        </a>
      </li>

      <!-- REGISTER: Admin & Operator -->
      <li class="nav-item" *ngIf="isAdmin || isOperator">
        <a routerLink="/app/register" routerLinkActive="active" class="nav-link" (click)="closeSidebar()">
          <i class="material-symbols-outlined">add_box</i> Registrar Encomenda
        </a>
      </li>

      <!-- CONSULT: Operator & Courier -->
      <li class="nav-item" *ngIf="isOperator || isCourier || isAdmin">
        <a routerLink="/app/consult" routerLinkActive="active" class="nav-link" (click)="closeSidebar()">
          <i class="material-symbols-outlined">search</i> Consultar Encomendas
        </a>
      </li>

      <!-- MANAGE USERS: Admin Only -->
      <li class="nav-item" *ngIf="isAdmin">
        <a routerLink="/app/users" routerLinkActive="active" class="nav-link" (click)="closeSidebar()">
          <i class="material-symbols-outlined">manage_accounts</i> Gerenciar Usu√°rios
        </a>
      </li>
    </ul>
  </div>

  <div class="main-content">
    <div class="header">
      <button class="mobile-menu-btn" (click)="toggleSidebar()">
        <i class="material-symbols-outlined">menu</i>
      </button>

      <div class="user-menu">
        <div class="user-info" (click)="toggleUserMenu()">
          <div>
            <span class="user-name">{{ currentUser?.name }}</span>
            <span class="user-role">{{ getRoleLabel(currentUser?.role) }}</span>
          </div>
          <div class="user-avatar">
            <!-- Simple Avatar Logic -->
            {{ currentUser?.name?.charAt(0) }}
          </div>
        </div>

        <div class="dropdown-menu" [class.show]="isUserMenuOpen">
          <a href="javascript:void(0)" (click)="logout()" class="dropdown-item">
            <i class="material-symbols-outlined">logout</i> Sair
          </a>
        </div>
      </div>
    </div>

    <router-outlet></router-outlet>
  </div>
</div>
